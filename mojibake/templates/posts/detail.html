{% extends "header.html" %}

{% block content %}
<div class="row-fluid">
    <div class="span9 offset3">
        <h3>{{post.title}}</h3>
        <p>Posted by: <a href="{{ url_for('profile', username = post.author.username) }}">{{post.author.username}}</a> at <em>{{post.created_at.strftime('%H:%M %Y-%m-%d')}}</em></p>
        <p>Tags: {% for tag in post.tags %}{{tag}}{% endfor %}</p>
        {% if g.user.is_authenticated() %}
        <p><a href="{{ url_for('edit_post', slug=slug) }}">Edit post</a></p>
        {% endif %}
        <p>{{post.body}}</p>
        <h4>Comments</h4>
        <form action="" method="post" name="edit">
            {{form.hidden_tag()}}
            <p>Author:</p>
            <p>{{form.author}}</p>
            {% for error in form.errors.author %}
            <div class="alert alert-error">
                <p>[{{error}}]</p>
            </div>
            {% endfor %}
            <p>Email: </p>
            <p>{{form.email}}</p>
            {% for error in form.errors.email %}
            <div class="alert alert-error">
                <p>[{{error}}]</p>
            </div>
            {% endfor %}
            <p>Comment: </p>
            <p>{{form.body}}</p>
            {% for error in form.errors.body %}
            <div class="alert alert-error">
                <p>[{{error}}]</p>
            </div>
            {% endfor %}
            <p><input type="submit" value="Submit"></p>
        </form>
        {% if post.get_visible_comments() %}
            {% for comment in post.get_visible_comments() %}
                {% include 'posts/comment.html' %}
            {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}