{% extends "base.html" %}

{% block title %}Defestri - Break-in attempts &amp; Bans{% endblock %}

{% block content %}
<section class="bans">
    <div class="container">

        <header>
            <a href="{{ url_for('bans') }}"><h2>{{ _('Break-in attempts &amp; Bans') }}</h2></a>

        </header>

        <p>{{ _('For the month of %(last_month)s', last_month=last_month.strftime('%B, %Y')) }}.</p>
            <!--<span class="pull-right">All times posted are </span></p>-->

        <h3 style="padding-bottom: 10px;">{{ _('Break-in attempts') }}</h3>
        <table class="default">
            <thead>
                <tr>
                    <th>{{ _('When') }}</th>
                    <th>{{ _('Username') }}</th>
                    <th>{{ _('IP') }}</th>
                    <th>{{ _('Location') }}</th>
                </tr>
            </thead>
            <tfoot class="row-total">
                <td>{{ _('Total') }}:</td>
                <td colspan="3">{{ breakin_attempts|length }}</td>
            </tfoot>
            <tbody>
                {% for breakin in breakin_attempts %}
                <tr>
                    <td>{{moment_js(breakin.date).format('L, LT')}}</td>
                    <td>{{ breakin.user }}</td>
                    <td>{{ breakin.ip.ip_addr }}</td>
                    <td>{{ breakin.ip.print_location() }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h3 style="padding-bottom: 10px;">{{ _('Bans') }}</h3>
        <table class="default">
            <thead>
                <tr>
                    <th>{{ _('When') }}</th>
                    <th>{{ _('IP') }}</th>
                    <th>{{ _('Location') }}</th>
                </tr>
            </thead>
            <tfoot class="row-total">
                <td>{{ _('Total')}}:</td>
                <td colspan="2">{{ bans|length }}</td>
            </tfoot>
            <tbody>

                {% for ban in bans %}
                <tr class="{{ loop.cycle('odd', 'even')}}">
                    <td>{{moment_js(ban.date).format('L, LT')}}</td>
                    <td>{{ ban.ip.ip_addr }}</td>
                    <td>{{ ban.ip.print_location() }}</td>
                </tr>
                {% endfor %}

            </tbody>
        </table>

        <!--<p><small>Automatically generated by the <a href="https://github.com/ardinor/misc/tree/master/auth-log%20parser">auth-log parser</a>.</small></p>-->

    </div>
</section>
{% endblock %}
